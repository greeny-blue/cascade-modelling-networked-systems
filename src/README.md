# SOC Forest Fire (animated): `soc_forest_v11.py`

A single-file implementation of the **self-organised critical (SOC) forest-fire model** (Drossel–Schwabl style) with an optional **Pygame animation**, plus basic logging for offline analysis.

This script evolves a 2D lattice of cells through repeated **drive** (slow growth + rare lightning) and **fire** (fast burning) phases. Over long runs, the distribution of fire sizes typically becomes heavy-tailed, illustrating SOC-like behaviour.

---

## What the model does

Each cell is in one of three states:

- **1** = tree  
- **2** = burning tree  
- **3** = empty / soil  

Simulation alternates between:

- **DRIVE phase** (slow):  
  - Empty cells grow trees with probability `p_grow` per cell per drive step  
  - Trees ignite with probability `p_lightning` per cell per drive step  
- **FIRE phase** (fast):  
  - Burning trees spread to neighbouring trees (von Neumann neighbourhood)  
  - Burning trees become empty  
  - When no burning cells remain, the system returns to DRIVE

---

## Features

- Real-time animation (Pygame) with pause/reset/screenshot controls
- Headless mode for faster runs (`--no-graphics`)
- Logs:
  - Fire sizes (trees burned per fire)
  - Fire durations (CA steps per fire)
  - Optional tree density time series
  - Optional saving of **pre-burn** lattice states for each fire (`.npz`)
- Optional automatic screenshots of every fire step (graphics mode)

---

## Requirements

- Python 3.9+ (likely works on earlier 3.x too)
- `numpy`
- `pygame`

Install dependencies:

```bash
pip install numpy pygame
```

---

## Quick start

### Animated run (default)

```bash
python soc_forest_v11.py
```

### Headless run (faster)

```bash
python soc_forest_v11.py --no-graphics
```

### Reproducible run (fixed seed)

```bash
python soc_forest_v11.py --seed 123
```

### Interactive parameter prompts

```bash
python soc_forest_v11.py --interactive
```

---

## CLI options (most useful)

Run `python soc_forest_v11.py --help` for the full list. Common parameters:

- `--grid-size` : lattice size (cells per side)
- `--init-tree` : initial tree cover proportion (0–1)
- `--p-grow` : tree growth probability per cell per DRIVE step
- `--p-lightning` : lightning probability per cell per DRIVE step
- `--steps-per-frame` : number of DRIVE steps per rendered frame
- `--fire-steps-per-frame` : number of FIRE CA steps per rendered frame
- `--fps` : animation frame rate (graphics mode)
- `--max-runs` and `--limit-by {fires,frames}` : stop conditions
- `--track-density` and `--density-log-interval` : density time series logging
- `--auto-screenshots` and `--screenshot-dir` : save each FIRE step as PNGs
- `--no-graphics` : disable Pygame rendering (faster)

---

## Keyboard controls (graphics mode)

- **Space / P**: pause / resume  
- **R**: reset to empty soil (returns to DRIVE mode)  
- **S**: save a manual screenshot PNG
- **Q**: quit  

---

## Output files

Created in the working directory:

- `socsim_output_fire_sizes.txt`  
  One fire size per line (trees burned).

- `socsim_output_fire_sizes_durations.txt`  
  One fire duration per line (number of FIRE CA steps).  
  *(Filename is generated by appending `_durations` to the fire-size log name.)*

- `socsim_output_density_timeseries.txt`  
  Tab-separated `frame\t rho` (tree density), if `--track-density` is enabled.

- `socsim_output_preburn_states.npz`  
  Compressed NumPy archive containing `preburn_states` with shape  
  `(n_fires, grid_size, grid_size)`.

- Automatic screenshots (optional):  
  `socsim_automatic_screenshots/fire_00001_step_00010.png`, etc.

---

## Notes and tips

- SOC-like behaviour typically requires **separation of timescales**: slow DRIVE (growth/lightning) and fast FIRE dynamics.
- For large `grid-size`, prefer `--no-graphics` to generate large samples quickly.
- If you plan to analyse fire-size distributions, you’ll usually want **many thousands** of fires.

---

## Reference

This model is inspired by the classic Drossel–Schwabl forest-fire model (often discussed under self-organised criticality / forest-fire SOC models).

If you use this code in academic work, consider citing the Drossel–Schwabl model and/or SOC literature.

---

## Licence

XXX Add a licence (e.g. MIT, Apache-2.0, GPL-3.0).  
